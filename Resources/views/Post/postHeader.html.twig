<header>
    {% if 'blog_view' == mode %}
        <h1><a href="{{ path('icap_blog_post_view', {'blogId': _resource.id, 'postSlug': post.slug}) }}" title="">{{ post.title }}</a></h1>
    {% elseif 'search_view' == mode %}
        <h1>{{ post.title|highlight(search)|raw }}</h1>
    {% else %}
        <h1>{{ post.title }}</h1>
    {% endif %}

    {% if is_granted('EDIT', _resourceNode) or (is_granted('POST', _resourceNode) and post.author == user) %}
    <div class="btn-group pull-right options">
        {% if is_granted('EDIT', _resourceNode) %}
            {% if isPublished %}
            <a href="{{ path('icap_blog_post_unpublish', {'blogId': _resource.id, 'postSlug': post.slug}) }}" class="btn btn-default btn-red btn-xs">
                <span class="icon-minus-sign"></span> {{ 'unpublish'|trans({}, 'icap_blog') }}
            </a>
            {% else %}
            <a href="{{ path('icap_blog_post_publish', {'blogId': _resource.id, 'postSlug': post.slug}) }}" class="btn btn-default btn-green btn-xs">
                <span class="icon-ok-sign"></span> {{ 'publish'|trans({}, 'icap_blog') }}
            </a>
            {% endif %}
        {% endif %}
        <a href="{{ path('icap_blog_post_edit', {'blogId': _resource.id, 'postSlug': post.slug}) }}" class="btn btn-primary btn-xs">
            <span class="icon-edit"></span> {{ 'edit'|trans({}, 'platform') }}
        </a>
        <a href="{{ path('icap_blog_post_delete', {'blogId': _resource.id, 'postSlug': post.slug}) }}" class="btn btn-xs btn-danger delete" data-confirm-title="{{ 'post_deletion_confirm_title'|trans({}, 'icap_blog') }}" data-confirm-message="{{ 'post_deletion_confirm_message'|trans({'%postName%': post.title}, 'icap_blog') }}" data-confirm-ok="{{ 'delete'|trans({}, 'platform') }}" data-confirm-cancel="{{ 'cancel'|trans({}, 'platform') }}" data-toggle="tooltip" data-container="body" title="{{ 'delete'|trans({}, 'platform') }}" data-placement="top" data-original-title="{{ 'delete'|trans({}, 'platform') }}">
            <span class="icon-trash"></span>
        </a>
    </div>
    {% endif %}

    {% set author = post.author %}
    <ul class="list-inline post_infos">
        <li><span class="icon-user"></span> <small><a href="{{ path('icap_blog_view_filter', {'blogId': _resource.id, 'filter': author.username}) }}" rel="author" title="{{ author.firstname ~ ' ' ~ author.lastname }}">{{ author.firstname ~ ' ' ~ author.lastname }}</a></small></li>
        {% if null != post.publicationDate %}
        <li><span class="icon-calendar"></span> <small><time>{{ post.publicationDate|date('date_format'|trans({}, 'platform')) }}</time></small></li>
        {% endif %}
    </ul>
</header>
